\documentclass[a4paper,11pt]{article}

\usepackage{a4wide}
\usepackage{tikz}

\usepackage{amsmath,bm}
\newcommand{\td}{\mathrm{d}}
\newcommand{\te}{\mathrm{e}}
\newcommand{\ti}{\mathrm{i}}
\newcommand{\sinc}{\mathrm{sinc}}
\newcommand{\sign}{\mathrm{sign}}
\newcommand{\atan}{\mathrm{atan}}
\usepackage{tikz}

\title {Analytical integrals of the 2D Laplace kernel}

\begin{document}

\maketitle

\section{Introduction}

This document describes the analytical formulae used to integrate the kernel of the Laplace equation in two dimensions over straight lines.

The kernel is defined as
%
\begin{equation}
G({\bf y}, {\bf x}) = -\frac{\ln |{\bf y}-{\bf x}|}{2\pi} = -\frac{\ln r}{2\pi}
\end{equation}
%
where ${\bf x}$ is the source point. The kernel exhibits a weak (integrable) singularity when $r \to 0$.

The kernel's normal derivative can be written as
%
\begin{equation}
G'_{n_y}({\bf y}, {\bf x}) = -\frac{({\bf y}-{\bf x}) \cdot {\bf n}_y}{2\pi r^2}
\end{equation}
%
this derivative kernel contains a strong singularity and can be integrated in a CPV sense.

The kernel's second derivative (on a plane element) is computed as
%
\begin{equation}
G''_{n_x n_y}({\bf x}, {\bf y}) = \frac{{\bf n}_x \cdot {\bf n}_y}{2\pi r^2} = \frac{1}{2\pi r^2}
\end{equation}


\section{Collocation}

The following parts describe the case of collocation where ${\bf x}$ is a fixed location and integration is performed with respect to the variable ${\bf y}$.


\subsection{Regular integrals}

\begin{figure}
\center
\begin{tikzpicture}[scale=1]
\small
\draw [thin, ->] (2,1) -- (3,.5) node [right] {$\xi$};
\draw [thin, ->] (2,1) -- (2.5,2) node [left] {$\eta$};
\path [draw, fill] (3,3) circle(.05) node [right] {${\bf x}_0$};
\path [draw, very thick, fill] (4,0) circle(.05) node [below] {${\bf y}_2$} -- (4.5,-.25) circle(.05) node [below] {${\bf y}$} -- (6,-1) circle(.05) node [below] {${\bf y}_1$};
\path [draw, thick, ->] (5,-.5) -- (5.5,.5) node [above] {${\bf n}$};
\end{tikzpicture}
\caption{Coordinate transform for the definition of the regular integrals over the straight line element}
\label{fig:regular_local}
\end{figure}

In order to define the regular integrals in a convenient way local coordinates are introduced, as shown in Fig.~\ref{fig:regular_local}:
\begin{align}
\xi &= ({\bf y} - {\bf x}_0) \cdot \frac{{\bf y}_1 - {\bf y}_2}{|{\bf y}_1 - {\bf y}_2|} \nonumber \\
\eta &= ({\bf x}_0 - {\bf y}) \cdot {\bf n}
\end{align}

\subsubsection{SLP kernel}

The regular integral of the single layer potential kernel can be transformed to the general form
%
\begin{equation}
I = \frac{-1}{2\pi} \int_{\xi_2}^{\xi_1} \ln\left(\sqrt{\xi^2+\eta^2}\right) \left(a_0 + a_1 \xi + a_2 \xi^2\right) \td \xi
\end{equation}
%
The regularity of the integrand is ensured if $\eta \ne 0$ or $\sign \xi_1 = \sign \xi_2$

\begin{equation}
I = \frac{1}{2\pi} \left[
\left(\frac{1}{9} - \frac{\ln \rho}{3}\right) a_2 \xi^3
+ \frac{a_1 \xi^2}{4}
- \frac{a_1 \rho^2 \ln \rho}{2} 
- a_0 \xi \ln \rho
+ \left(\frac{a_2 \eta^2}{3} - a_0 \right) \left(\eta \atan\frac{\xi}{\eta} - \xi\right)
\right]_{\xi_2}^{\xi_1}
\end{equation}
%
where $\rho = r = \sqrt{\xi^2+\eta^2}$.

\subsubsection{DLP kernel}

For the case of the double layer potential kernel, the integral is transformed as
%
\begin{equation}
I = \frac{-1}{2\pi} \int_{\xi_2}^{\xi_1} \frac{-\eta \left(a_0 + a_1 \xi + a_2 \xi^2 \right)}{\xi^2+\eta^2}\td \xi
= \frac{1}{2\pi} \left[
\left( a_0 - a_2 \eta^2\right) \atan \frac{\xi}{\eta} + \left(a_2 \xi + a_1 \ln r\right) \eta
\right]_{\xi_2}^{\xi_1}
\end{equation}

\subsection{Constant line SLP}

\begin{align}
\int_{S} G({\bf y}, {\bf x}) \td y
& = \frac{-1}{2\pi}\lim_{\epsilon \to 0}
\left( \int_{-d_1}^{-\epsilon} \ln |y| \td y + \int_{\epsilon}^{d_2}  \ln |y| \td y \right) \nonumber \\
& = \frac{-1}{2\pi}\lim_{\epsilon \to 0}
\left( \int_{\epsilon}^{d_1} \ln y \td y + \int_{\epsilon}^{d_2}  \ln y \td y \right) \nonumber \\
&=
\frac{d_1(1-\ln d_1) + d_2(1-\ln d_2)}{2\pi}
\end{align}

\subsection{Constant line DLP}

\begin{equation}
\int_{S} G'_{n_y}({\bf y}, {\bf x}) \td y = 0
\end{equation}
%
as the element normal is perpendicular to the distance ${\bf y}-{\bf x}$.

\subsection{Constant line HSP}

First approach: finite part integral
%
\begin{align}
\int_{S} G''_{n_x n_y}({\bf y}, {\bf x}) \td y
&= \frac{1}{2\pi} \lim_{\epsilon \to 0} \left(\int_{-d_1}^{-\epsilon} \frac{1}{y^2}\td y + \int_{\epsilon}^{d_2} \frac{1}{y^2} \td y\right) \nonumber \\
&= \frac{1}{2\pi} \lim_{\epsilon \to 0} \left(\left[\frac{-1}{y}\right]_{-d_1}^{-\epsilon} +  \left[\frac{-1}{y}\right]_{\epsilon}^{d_2} \right)
\nonumber \\
&= \frac{-1}{2\pi} \left(\frac{1}{d_1} +  \frac{1}{d_2} \right) + \lim_{\epsilon \to 0} \frac{1}{\pi\epsilon}
\end{align}


Second approach: approaching the boundary:
%
\begin{align}
\frac{\partial}{\partial n_x}
\int_{-d_1}^{d_2} 
\frac{\partial}{\partial n_y}
\frac{-\ln |r|}{2\pi}
\td y 
&=
\frac{\partial}{\partial z}
\int_{-d_1}^{d_2} 
\frac{-1}{2\pi r} \frac{(y, -z) \cdot (0,1)}{r}
\td y \nonumber \\
&=
\frac{1}{2\pi} \frac{\partial}{\partial z}
\int_{-d_1}^{d_2} 
\frac{z}{\left(y^2+z^2\right)}
\td y \nonumber \\
&=
\frac{1}{2\pi} \frac{\partial}{\partial z}
\left[
\tan^{-1}\left(d_2/z\right)
-
\tan^{-1}\left(-d_1/z\right)
\right]
\nonumber \\
&=
\frac{1}{2\pi} \frac{\partial}{\partial z}
\left[
\tan^{-1}\left(d_2/z\right) + \tan^{-1}\left(d_1/z\right)
\right]
\nonumber \\
&=
\frac{1}{2\pi} 
\left[
\frac{-d_2}{d_2^2+z^2} + \frac{-d_1}{d_1^2+z^2}
\right]
\nonumber \\
& \to
\frac{-1}{2\pi} 
\left[
\frac{1}{d_2} + \frac{1}{d_1}
\right]
\end{align}


\section{Galerkin}

\subsection{Face match}

\subsubsection{Constant line SLP}

\begin{equation}
\int_{0}^{d}
\lim_{\epsilon \to 0}
\left(
\int_{0}^{x-\epsilon} G(x-y) \td y
+
\int_{x+\epsilon}^{d} G(x-y) \td y
\right)
\td x
=
d^2\frac{3-2\ln d}{4\pi}
\end{equation}

\subsubsection{Linear line SLP}

\begin{equation}
\int_{0}^{d} N_i(x) \int_{0}^{d} G(x-y) N_j(y) \td y \td x
=
\frac{d^2}{32\pi} \begin{bmatrix}
7-4 \ln d & 5 - 4 \ln d \\
5-4 \ln d & 7 - 4 \ln d
\end{bmatrix}
\end{equation}

\subsection{Edge match}

\subsubsection{Constant line SLP}

\begin{multline}
\int_{S_{x}} \int_{S_{y}} G(r) \td S_y \td S_x =
\int_{0}^{d_1} \int_{0}^{d_2}
\ln \sqrt{(x+y \cos\phi)^2 + (y\sin\phi)^2}
\td y \td x \\
=
\frac{
c \left(d_1^2 \ln \frac{d_1}{d_3} + {d_2}^2 \ln \frac{d_2}{d_3}\right)
+ s \left(d_1^2 q(d_1, d_2, \phi) + d_2^2 q(d_2, d_1, \phi)\right)
+ d_1 d_2 \left(3 - 2 \ln d_3 \right)
}{
4 \pi
}
\end{multline}
%
where
%
\begin{equation}
q(d_1, d_2, \phi) = \tan^{-1}\left(\frac{d_2 + d_1 \cos\phi}{d_1 \sin\phi}\right) - \tan^{-1}\left(\cot\phi\right)
\end{equation}

\subsubsection{Constant line DLP}

\begin{multline}
\int_{S_{x}} \int_{S_{y}} G'(r) r'_{n_{y}} \td S_y \td S_x =
\int_{0}^{d_1} \int_{0}^{d_2}
\frac{x\sin\phi}{(x+y \cos\phi)^2 + (y\sin\phi)^2}
\td y \td x \\
=
\frac{1}{2\pi}\left(-d_1 q(d_1, d_2, \phi) + d_2 \cos\phi q(d_2, d_1, \phi)
- d_2 \sin\phi \ln \frac{d_3}{d_2}\right)
\end{multline}

\end{document}

