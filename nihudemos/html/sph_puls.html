
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
      <!--
This HTML is auto-generated from an M-file.
To make changes, update the M-file and republish this document.
      -->
      <title>Radiation from a pulsating sphere</title>
      <meta name="generator" content="MATLAB 7.8">
      <meta name="date" content="2009-11-11">
      <meta name="m-file" content="sph_puls"><style type="text/css">

body {
  background-color: white;
  margin:10px;
}

h1 {
  color: #990000; 
  font-size: x-large;
}

h2 {
  color: #990000;
  font-size: medium;
}

/* Make the text shrink to fit narrow windows, but not stretch too far in 
wide windows. */ 
p,h1,h2,div.content div {
  max-width: 600px;
  /* Hack for IE6 */
  width: auto !important; width: 600px;
}

pre.codeinput {
  background: #EEEEEE;
  padding: 10px;
}
@media print {
  pre.codeinput {word-wrap:break-word; width:100%;}
} 

span.keyword {color: #0000FF}
span.comment {color: #228B22}
span.string {color: #A020F0}
span.untermstring {color: #B20000}
span.syscmd {color: #B28C00}

pre.codeoutput {
  color: #666666;
  padding: 10px;
}

pre.error {
  color: red;
}

p.footer {
  text-align: right;
  font-size: xx-small;
  font-weight: lighter;
  font-style: italic;
  color: gray;
}

  </style></head>
   <body>
      <div class="content">
         <h1>Radiation from a pulsating sphere</h1>
         <!--introduction-->
         <p>This tutorial introduces how to use the toolbox <tt>NIHU</tt> to solve a simple exterior acoustic radiation problem.
         </p>
         <p>The problem is radiation by a pulsating sphere to the infinite exterior domain. The boundary conditions are defined as prescribed
            pressure derivative (normal velocity) on the sphere surface. The computed surface and field point pressures are compared with
            analytical solutions.
         </p>
         <!--/introduction-->
         <h2>Contents</h2>
         <div>
            <ul>
               <li><a href="#1">Surface mesh generation</a></li>
               <li><a href="#5">Boundary conditions</a></li>
               <li><a href="#6">Generate BEM matrices and solve system</a></li>
               <li><a href="#8">Generate field point mesh</a></li>
               <li><a href="#9">Compute field point pressure</a></li>
            </ul>
         </div>
         <h2>Surface mesh generation<a name="1"></a></h2>
         <p>Generate a sphere geometry with given radius and division parameter. The division parameter is the number of elements along
            the radius of the sphere.
         </p><pre class="codeinput">R = 1;      <span class="comment">% radius</span>
nR = 10;    <span class="comment">% division parameter</span>
mesh = create_sphere_boundary(R, nR);
</pre><p>Check that the mesh is directed outward by plotting the normals with the toolbox function <a href="matlab:doc('plot_elem_normals')">plot_elem_normals</a></p><pre class="codeinput">figure;
plot_mesh(mesh);
plot_elem_normals(mesh);
view(3);
</pre><img vspace="5" hspace="5" src="sph_puls_01.png" alt=""> <p>The maximal applicable frequency is determined by the rule of thumb</p>
         <p><img src="sph_puls_eq83420.png" alt="$$L_e \le \lambda / 7$$"></p>
         <p>The maximal applicable wave number at each element of the mesh is computed by the toolbox function <a href="matlab:doc('bemkmax')">bemkmax</a>.
         </p><pre class="codeinput">ratio = 7;
kmax_elem = bemkmax(mesh, ratio);

figure;
plot_mesh(mesh, kmax_elem); view(3);
c = colorbar; ylabel(c, <span class="string">'k_{max} [1/m]'</span>);
</pre><img vspace="5" hspace="5" src="sph_puls_02.png" alt=""> <p>The minimum of these values is the overall frequency limit of computations with this mesh. In the present example, the wave
            number is set slightly lower than the maximal applicable wave number.
         </p><pre class="codeinput">kmax = min(kmax_elem);
k = .9*kmax;
</pre><h2>Boundary conditions<a name="5"></a></h2>
         <p>The boundary conditions are defied on the sphere element corners (nodes) as a uniform normal derivative <img src="sph_puls_eq76633.png" alt="$q_s = 1$">.
         </p><pre class="codeinput">nNodes = size(mesh.Nodes,1);
qs = ones(nNodes,1);
</pre><h2>Generate BEM matrices and solve system<a name="6"></a></h2>
         <p>The BEM system matrices are generated by the toolbox function <a href="matlab:doc('bemHG')">bemHG</a>. The system of equations
         </p>
         <p><img src="sph_puls_eq69235.png" alt="$$ {\bf H} {\bf p}_s = {\bf G} {\bf q}_s $$"></p>
         <p>is solved by direct matrix inversion.</p><pre class="codeinput">[H, G] = bemHG(mesh, k, <span class="string">'lin'</span>); <span class="comment">% Generate BEM matrices</span>
ps = H \ (G * qs);              <span class="comment">% solve the system</span>
</pre><p>The surface pressure <img src="sph_puls_eq38467.png" alt="$p_s$"> is compared to the analytical solution of the problem. The analytical solution is
         </p>
         <p><img src="sph_puls_eq58462.png" alt="$$ p_s = \frac{-1}{1+\i k R} $$"></p><pre class="codeinput">ps0 = -1 ./ (1+1i*k*R);     <span class="comment">% analytical pressure</span>
e = norm(ps-ps0)/norm(repmat(ps0,nNodes,1));    <span class="comment">% compute relative error</span>

figure;
plot_mesh(mesh, abs(ps)); view(3);
c = colorbar; ylabel(c, <span class="string">'Pressure magnitude'</span>);
title(sprintf(<span class="string">'Relative error: %e'</span>, e));
</pre><img vspace="5" hspace="5" src="sph_puls_03.png" alt=""> <h2>Generate field point mesh<a name="8"></a></h2>
         <p>The field point mesh is an annular ring generated by revolving a line.</p><pre class="codeinput">field = create_line([1.2*R 0 0; 3*R 0 0], 2*nR);
field = revolve_mesh(field, [0 0 0], [0 -1 0], pi/4/nR, 2*nR);

figure;
plot_mesh(mesh);
plot_mesh(field); view(3);
</pre><img vspace="5" hspace="5" src="sph_puls_04.png" alt=""> <h2>Compute field point pressure<a name="9"></a></h2>
         <p>The points of the field point mesh are extracted from the structure <tt>field</tt>, and are used to generate the field point BEM matrices with the toolbox function <a href="matlab:doc('bemHG')">bemHG</a>. The field point pressure <img src="sph_puls_eq87470.png" alt="$p_f$"> is computed as
         </p>
         <p><img src="sph_puls_eq60286.png" alt="$${\bf p}_f = \frac{1}{4\pi} ({\bf H} {\bf p}_s - {\bf G} {\bf q}_s)$$"></p><pre class="codeinput">points = field.Nodes(:,2:4);            <span class="comment">% field point coordinates</span>
[H, G] = bemHG(mesh, k, <span class="string">'lin'</span>, points);
pf = (H * ps - G * qs) / (4*pi);
</pre><p>The field point pressure is compared to the analytical solution. The analytical solution is given by</p>
         <p><img src="sph_puls_eq10530.png" alt="$$ p_f = p_s \frac{R}{r} \exp(-\i k (r-R)) $$"></p><pre class="codeinput">r = sqrt(dot(points,points,2));
pf0 = ps0 * (R./r) .* exp(-1i*k*(r-R));
e = norm(pf-pf0)/norm(pf0);

figure;
plot_mesh(mesh, real(ps));
plot_mesh(field, real(pf));
c = colorbar; ylabel(c, <span class="string">'Real pressure'</span>);
title(sprintf(<span class="string">'Relative error: %e'</span>, e));
view(3);
</pre><img vspace="5" hspace="5" src="sph_puls_05.png" alt=""> <p class="footer"><br>
            Published with MATLAB&reg; 7.8<br></p>
      </div>
      <!--
##### SOURCE BEGIN #####
%% Radiation from a pulsating sphere
% This tutorial introduces how to use the toolbox |NIHU| to solve a simple
% exterior acoustic radiation problem.
%
% The problem is radiation by a pulsating sphere to the infinite exterior
% domain. The boundary conditions are defined as prescribed pressure
% derivative (normal velocity) on the sphere surface.
% The computed surface and field point pressures are compared with
% analytical solutions.

%% Surface mesh generation
% Generate a sphere geometry with given radius and division parameter. The
% division parameter is the number of elements along the radius of the
% sphere.
R = 1;      % radius
nR = 10;    % division parameter
mesh = create_sphere_boundary(R, nR);

%%
% Check that the mesh is directed outward by plotting the normals with the
% toolbox function <matlab:doc('plot_elem_normals') plot_elem_normals>
figure;
plot_mesh(mesh);
plot_elem_normals(mesh);
view(3);

%%
% The maximal applicable frequency is determined by the rule of thumb
% 
% $$L_e \le \lambda / 7$$
% 
% The maximal applicable wave number at each element of the mesh is
% computed by the toolbox function <matlab:doc('bemkmax') bemkmax>.
ratio = 7;
kmax_elem = bemkmax(mesh, ratio);

figure;
plot_mesh(mesh, kmax_elem); view(3);
c = colorbar; ylabel(c, 'k_{max} [1/m]');
%%
% The minimum of these values
% is the overall frequency limit of computations with this mesh.
% In the present example, the wave number is set slightly lower than the
% maximal applicable wave number.
kmax = min(kmax_elem);
k = .9*kmax;

%% Boundary conditions
% The boundary conditions are defied on the sphere element corners (nodes)
% as a uniform normal derivative $q_s = 1$.
nNodes = size(mesh.Nodes,1);
qs = ones(nNodes,1);

%% Generate BEM matrices and solve system
% The BEM system matrices are generated by the toolbox function <matlab:doc('bemHG') bemHG>.
% The system of equations
%
% $$ {\bf H} {\bf p}_s = {\bf G} {\bf q}_s $$
%
% is solved by direct matrix inversion.
[H, G] = bemHG(mesh, k, 'lin'); % Generate BEM matrices
ps = H \ (G * qs);              % solve the system

%%
% The surface pressure $p_s$ is compared to the analytical solution of
% the problem. The analytical solution is
%
% $$ p_s = \frac{-1}{1+\i k R} $$
%
ps0 = -1 ./ (1+1i*k*R);     % analytical pressure
e = norm(ps-ps0)/norm(repmat(ps0,nNodes,1));    % compute relative error

figure;
plot_mesh(mesh, abs(ps)); view(3);
c = colorbar; ylabel(c, 'Pressure magnitude');
title(sprintf('Relative error: %e', e));

%% Generate field point mesh
% The field point mesh is an annular ring generated by revolving a line.
field = create_line([1.2*R 0 0; 3*R 0 0], 2*nR);
field = revolve_mesh(field, [0 0 0], [0 -1 0], pi/4/nR, 2*nR);

figure;
plot_mesh(mesh);
plot_mesh(field); view(3);

%% Compute field point pressure
% The points of the field point mesh are extracted from the structure
% |field|, and are used to generate the field point BEM matrices with the
% toolbox function <matlab:doc('bemHG') bemHG>. The field point pressure $p_f$ is computed as
% 
% $${\bf p}_f = \frac{1}{4\pi} ({\bf H} {\bf p}_s - {\bf G} {\bf q}_s)$$
% 
points = field.Nodes(:,2:4);            % field point coordinates
[H, G] = bemHG(mesh, k, 'lin', points);
pf = (H * ps - G * qs) / (4*pi);

%%
% The field point pressure is compared to the analytical solution. The
% analytical solution is given by
%
% $$ p_f = p_s \frac{R}{r} \exp(-\i k (r-R)) $$
%
r = sqrt(dot(points,points,2));
pf0 = ps0 * (R./r) .* exp(-1i*k*(r-R));
e = norm(pf-pf0)/norm(pf0);

figure;
plot_mesh(mesh, real(ps));
plot_mesh(field, real(pf));
c = colorbar; ylabel(c, 'Real pressure');
title(sprintf('Relative error: %e', e));
view(3);
##### SOURCE END #####
-->
   </body>
</html>