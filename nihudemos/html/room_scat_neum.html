
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
      <!--
This HTML is auto-generated from an M-file.
To make changes, update the M-file and republish this document.
      -->
      <title>Neumann interior scattering problem</title>
      <meta name="generator" content="MATLAB 7.8">
      <meta name="date" content="2009-11-10">
      <meta name="m-file" content="room_scat_neum"><style type="text/css">

body {
  background-color: white;
  margin:10px;
}

h1 {
  color: #990000; 
  font-size: x-large;
}

h2 {
  color: #990000;
  font-size: medium;
}

/* Make the text shrink to fit narrow windows, but not stretch too far in 
wide windows. */ 
p,h1,h2,div.content div {
  max-width: 600px;
  /* Hack for IE6 */
  width: auto !important; width: 600px;
}

pre.codeinput {
  background: #EEEEEE;
  padding: 10px;
}
@media print {
  pre.codeinput {word-wrap:break-word; width:100%;}
} 

span.keyword {color: #0000FF}
span.comment {color: #228B22}
span.string {color: #A020F0}
span.untermstring {color: #B20000}
span.syscmd {color: #B28C00}

pre.codeoutput {
  color: #666666;
  padding: 10px;
}

pre.error {
  color: red;
}

p.footer {
  text-align: right;
  font-size: xx-small;
  font-weight: lighter;
  font-style: italic;
  color: gray;
}

  </style></head>
   <body>
      <div class="content">
         <h1>Neumann interior scattering problem</h1>
         <!--introduction-->
         <p>This tutorial introduces how to use the toolbox <tt>NIHU</tt> to solve a simple interior acoustic scattering problem.
         </p>
         <p>The problem is scattering of an incident monopole wave field from the rigid walls of a shoe-box shaped room.</p>
         <!--/introduction-->
         <h2>Contents</h2>
         <div>
            <ul>
               <li><a href="#1">Surface and field point mesh</a></li>
               <li><a href="#5">Incident wave field</a></li>
               <li><a href="#7">BEM matrices and solution</a></li>
               <li><a href="#8">Field point pressure and total pressure field (post processing)</a></li>
            </ul>
         </div>
         <h2>Surface and field point mesh<a name="1"></a></h2>
         <p>Generate a brick surface with given side lengths and division parameter.</p><pre class="codeinput">L = [5 4 3];    <span class="comment">% dimensions of the room [x y z]</span>
Le = .2;        <span class="comment">% lengt of boundary elements</span>
N = ceil(L/Le); <span class="comment">% division parameter</span>
mesh = create_brick_boundary(L, N);
</pre><p>Check that the mesh is directed inward by plotting the normals with the toolbox function <tt>plot_elem_normals</tt></p><pre class="codeinput">figure;
plot_mesh(mesh);
plot_elem_normals(mesh);
view(3);
</pre><img vspace="5" hspace="5" src="room_scat_neum_01.png" alt=""> <p>All the normals look outside, so the elements have to be flipped.</p><pre class="codeinput">mesh = flip_elements(mesh);

figure;
plot_mesh(mesh);
plot_elem_normals(mesh);
view(3);
</pre><img vspace="5" hspace="5" src="room_scat_neum_02.png" alt=""> <p>The field point mesh consists of three slabs parallel with the coordinate planes</p><pre class="codeinput">C = [
    .1 .1 .5
    .9 .1 .5
    .9 .9 .5
    .1 .9 .5
    ];
field1 = create_slab(C*diag(L), N([1,2]));
field2 = create_slab(C(:,[2 3 1])*diag(L), N([3,1]));
field3 = create_slab(C(:,[3 1 2])*diag(L), N([2,3]));
field = join_meshes(field1, field2, field3);

figure;
plot_mesh(field); view(3);
</pre><img vspace="5" hspace="5" src="room_scat_neum_03.png" alt=""> <h2>Incident wave field<a name="5"></a></h2>
         <p>The incident wave field is the field of a monopole source located inside the room. The incident pressure field <img src="room_scat_neum_eq83153.png" alt="$p_{si}$"> and pressure derivative field <img src="room_scat_neum_eq63720.png" alt="$q_{si}$"> is computed in all surface DOF. In the present example, constant boundary elements are used, and the DOF locations are the
            element centers. The element centers and normals are obtained from the toolbox function <tt>centnorm</tt>, and the toolbox function <tt>incident</tt> computes the incident surface pressure and velocity field. For visualization purposes, the incident pressure field is computed
            in the field points (vertices of the field point mesh).
         </p>
         <p>The frequency is determined from the element length</p><pre class="codeinput">ratio = 7;                  <span class="comment">% elements per wavelength</span>
k = .9 * 2*pi/(ratio * Le); <span class="comment">% wave number</span>

r0 = [.3 .6 .7] * diag(L);  <span class="comment">% monople source location</span>

[center, normal] = centnorm(mesh);
[psi, qsi] = incident(<span class="string">'point'</span>, r0, center, normal, k);

points = field.Nodes(:,2:4);    <span class="comment">% extract field points (vertices)</span>
pfi = incident(<span class="string">'point'</span>, r0, points, [], k);

figure;
plot_mesh(mesh, real(psi));
c = colorbar; ylabel(c, <span class="string">'Real incident pressure'</span>);
view(3);

figure;
plot_mesh(field, real(pfi)); shading <span class="string">interp</span>;
c = colorbar; ylabel(c, <span class="string">'Real incident pressure'</span>);
view(3);
</pre><img vspace="5" hspace="5" src="room_scat_neum_04.png" alt=""> <img vspace="5" hspace="5" src="room_scat_neum_05.png" alt=""> <h2>BEM matrices and solution<a name="7"></a></h2>
         <p>The BEM system matrices are generated by the toolbox function <tt>bemHG</tt>. The system of equations
         </p>
         <p><img src="room_scat_neum_eq97481.png" alt="$$ {\bf H} {\bf p}_{ss} = {\bf G} {\bf q}_{ss} $$"></p>
         <p>is solved by matrix inversion. As a rigid scatterer is considered, the scattered velocity field is computed from the incident
            velocity as
         </p>
         <p><img src="room_scat_neum_eq69915.png" alt="$$q_{ss} = -q_{si} $$"></p><pre class="codeinput">[H, G] = bemHG(mesh, k, <span class="string">'const'</span>);   <span class="comment">% Generate BEM matrices</span>
qss = -qsi;                         <span class="comment">% Boundary cond. at a rigid boundary</span>
pss = H \ (G * qss);                <span class="comment">% solve the system</span>
</pre><h2>Field point pressure and total pressure field (post processing)<a name="8"></a></h2>
         <p>The scattered field point pressure <img src="room_scat_neum_eq23573.png" alt="$p_{fs}$"> is computed from the scattered surface pressure <img src="room_scat_neum_eq98987.png" alt="$p_{ss}$"> and velocity <img src="room_scat_neum_eq32815.png" alt="$q_{ss}$"> as
         </p>
         <p><img src="room_scat_neum_eq65989.png" alt="$${\bf p}_{fs} = \frac{1}{4\pi} ({\bf H} {\bf p}_{ss} - {\bf G} {\bf q}_{ss})$$"></p>
         <p>where the system matrices are computed by the toolbox function <tt>bemHG</tt>.
         </p><pre class="codeinput">[H, G] = bemHG(mesh, k, <span class="string">'const'</span>, points);
pfs = (H * pss - G * qss) / (4*pi);
</pre><p>The total pressure field in the field points and on the surface is computed as</p>
         <p><img src="room_scat_neum_eq33402.png" alt="$$ p_t = p_i + p_s $$"></p><pre class="codeinput">pst = psi + pss;
pft = pfi + pfs;

figure;
plot_mesh(mesh, real(pst));
c = colorbar; ylabel(c, <span class="string">'Real pressure'</span>);
view(3);

figure;
plot_mesh(field, real(pft)); shading <span class="string">interp</span>;
c = colorbar; ylabel(c, <span class="string">'Real pressure'</span>);
view(3);
</pre><img vspace="5" hspace="5" src="room_scat_neum_06.png" alt=""> <img vspace="5" hspace="5" src="room_scat_neum_07.png" alt=""> <p class="footer"><br>
            Published with MATLAB&reg; 7.8<br></p>
      </div>
      <!--
##### SOURCE BEGIN #####
%% Neumann interior scattering problem
% This tutorial introduces how to use the toolbox |NIHU| to solve a simple
% interior acoustic scattering problem.
%
% The problem is scattering of an incident monopole wave field from the
% rigid walls of a shoe-box shaped room.

%% Surface and field point mesh
% Generate a brick surface with given side lengths and division parameter.
L = [5 4 3];    % dimensions of the room [x y z]
Le = .2;        % lengt of boundary elements
N = ceil(L/Le); % division parameter
mesh = create_brick_boundary(L, N);

%%
% Check that the mesh is directed inward by plotting the normals with the
% toolbox function |plot_elem_normals|
figure;
plot_mesh(mesh);
plot_elem_normals(mesh);
view(3);

%%
% All the normals look outside, so the elements have to be flipped.
mesh = flip_elements(mesh);

figure;
plot_mesh(mesh);
plot_elem_normals(mesh);
view(3);

%%
% The field point mesh consists of three slabs parallel with the coordinate
% planes
C = [
    .1 .1 .5
    .9 .1 .5
    .9 .9 .5
    .1 .9 .5
    ];
field1 = create_slab(C*diag(L), N([1,2]));
field2 = create_slab(C(:,[2 3 1])*diag(L), N([3,1]));
field3 = create_slab(C(:,[3 1 2])*diag(L), N([2,3]));
field = join_meshes(field1, field2, field3);

figure;
plot_mesh(field); view(3);

%% Incident wave field
% The incident wave field is the field of a monopole source located inside
% the room.
% The incident pressure field $p_{si}$ and pressure derivative field
% $q_{si}$ is computed in all surface DOF. In the present example,
% constant boundary elements are used, and the DOF locations are the
% element centers. The
% element centers and normals are obtained from the toolbox function
% |centnorm|, and the toolbox function |incident| computes the incident
% surface pressure and velocity field. For visualization purposes, the
% incident pressure field is computed in the field points (vertices of the
% field point mesh).

%%
% The frequency is determined from the element length
ratio = 7;                  % elements per wavelength
k = .9 * 2*pi/(ratio * Le); % wave number

r0 = [.3 .6 .7] * diag(L);  % monople source location

[center, normal] = centnorm(mesh);
[psi, qsi] = incident('point', r0, center, normal, k);

points = field.Nodes(:,2:4);    % extract field points (vertices)
pfi = incident('point', r0, points, [], k);

figure;
plot_mesh(mesh, real(psi));
c = colorbar; ylabel(c, 'Real incident pressure');
view(3);

figure;
plot_mesh(field, real(pfi)); shading interp;
c = colorbar; ylabel(c, 'Real incident pressure');
view(3);


%% BEM matrices and solution
% The BEM system matrices are generated by the toolbox function |bemHG|.
% The system of equations
%
% $$ {\bf H} {\bf p}_{ss} = {\bf G} {\bf q}_{ss} $$
%
% is solved by matrix inversion. As a rigid scatterer is considered, the
% scattered velocity field is computed from the incident velocity as
%
% $$q_{ss} = -q_{si} $$
%
[H, G] = bemHG(mesh, k, 'const');   % Generate BEM matrices
qss = -qsi;                         % Boundary cond. at a rigid boundary
pss = H \ (G * qss);                % solve the system

%% Field point pressure and total pressure field (post processing)
% The scattered field point pressure $p_{fs}$ is computed from the
% scattered surface pressure $p_{ss}$ and velocity $q_{ss}$ as
% 
% $${\bf p}_{fs} = \frac{1}{4\pi} ({\bf H} {\bf p}_{ss} - {\bf G} {\bf q}_{ss})$$
% 
% where the system matrices are computed by the toolbox function |bemHG|.
[H, G] = bemHG(mesh, k, 'const', points);
pfs = (H * pss - G * qss) / (4*pi);

%%
% The total pressure field in the field points and on the surface is
% computed as
%
% $$ p_t = p_i + p_s $$
%
pst = psi + pss;
pft = pfi + pfs;

figure;
plot_mesh(mesh, real(pst));
c = colorbar; ylabel(c, 'Real pressure');
view(3);

figure;
plot_mesh(field, real(pft)); shading interp;
c = colorbar; ylabel(c, 'Real pressure');
view(3);
##### SOURCE END #####
-->
   </body>
</html>