
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
      <!--
This HTML is auto-generated from an M-file.
To make changes, update the M-file and republish this document.
      -->
      <title>Neumann exterior scattering problem</title>
      <meta name="generator" content="MATLAB 7.8">
      <meta name="date" content="2009-11-10">
      <meta name="m-file" content="sph_scat_neum"><style type="text/css">

body {
  background-color: white;
  margin:10px;
}

h1 {
  color: #990000; 
  font-size: x-large;
}

h2 {
  color: #990000;
  font-size: medium;
}

/* Make the text shrink to fit narrow windows, but not stretch too far in 
wide windows. */ 
p,h1,h2,div.content div {
  max-width: 600px;
  /* Hack for IE6 */
  width: auto !important; width: 600px;
}

pre.codeinput {
  background: #EEEEEE;
  padding: 10px;
}
@media print {
  pre.codeinput {word-wrap:break-word; width:100%;}
} 

span.keyword {color: #0000FF}
span.comment {color: #228B22}
span.string {color: #A020F0}
span.untermstring {color: #B20000}
span.syscmd {color: #B28C00}

pre.codeoutput {
  color: #666666;
  padding: 10px;
}

pre.error {
  color: red;
}

p.footer {
  text-align: right;
  font-size: xx-small;
  font-weight: lighter;
  font-style: italic;
  color: gray;
}

  </style></head>
   <body>
      <div class="content">
         <h1>Neumann exterior scattering problem</h1>
         <!--introduction-->
         <p>This tutorial introduces how to use the toolbox <tt>NIHU</tt> to solve a simple exterior acoustic scattering problem.
         </p>
         <p>The problem is scattering of an incident plane wave from a rigid sphere.</p>
         <!--/introduction-->
         <h2>Contents</h2>
         <div>
            <ul>
               <li><a href="#1">Surface and field point mesh</a></li>
               <li><a href="#6">Incident wave field</a></li>
               <li><a href="#7">BEM matrices and solution</a></li>
               <li><a href="#8">Field point pressure and total pressure field (post processing)</a></li>
            </ul>
         </div>
         <h2>Surface and field point mesh<a name="1"></a></h2>
         <p>Generate a sphere surface with given radius and division parameter. The division parameter is the number of elements along
            the radius of the sphere.
         </p><pre class="codeinput">R = 1;      <span class="comment">% radius</span>
nR = 10;    <span class="comment">% division parameter</span>
mesh = create_sphere_boundary(R, nR);
</pre><p>Check that the mesh is directed outward by plotting the normals with the toolbox function <tt>plot_elem_normals</tt></p><pre class="codeinput">figure;
plot_mesh(mesh);
plot_elem_normals(mesh);
view(3);
</pre><img vspace="5" hspace="5" src="sph_scat_neum_01.png" alt=""> <p>The maximal applicable frequency is determined by the rule of thumb</p>
         <p><img src="sph_scat_neum_eq10713.png" alt="$$L_e \le \lambda/7$$"></p>
         <p>The maximal applicable wave number at each element of the mesh is computed by the toolbox function <tt>bemkmax</tt>.
         </p><pre class="codeinput">ratio = 7;                          <span class="comment">% elements per wavelength</span>
kmax_elem = bemkmax(mesh, ratio);   <span class="comment">% max. wave number per element</span>

figure;
plot_mesh(mesh, kmax_elem);
c = colorbar; ylabel(c, <span class="string">'k_{max} [1/m]'</span>);
view(3);
</pre><img vspace="5" hspace="5" src="sph_scat_neum_02.png" alt=""> <p>The minimum of these wavenumber values is the overall frequency limit of computations with this mesh. In the present example,
            the wave number is set slightly lower than the maximum.
         </p><pre class="codeinput">kmax = min(kmax_elem);
k = .9*kmax;
</pre><p>The field point mesh is an annular ring generated by revolving a line.</p><pre class="codeinput">field = create_line([0 0 1.2*R; 0 0 3*R], 2*nR);
field = revolve_mesh(field, [0 0 0], [0 -1 0], pi/4/nR, 4*nR);

figure;
plot_mesh(mesh);
plot_mesh(field); view(3);
</pre><img vspace="5" hspace="5" src="sph_scat_neum_03.png" alt=""> <h2>Incident wave field<a name="6"></a></h2>
         <p>The incident wave field is a plane wave travelling in a given direction. The incident pressure field <img src="sph_scat_neum_eq83153.png" alt="$p_{si}$"> and pressure derivative field <img src="sph_scat_neum_eq63720.png" alt="$q_{si}$"> is computed in all surface DOF. In the present example, constant boundary elements are used, and the DOF locations are the
            element centers. The element centers and normals are obtained from the toolbox function <tt>centnorm</tt>, and the toolbox function <tt>incident</tt> computes the incident surface pressure and velocity field. For visualization purposes, the incident pressure field is computed
            in the field points (vertices of the field point mesh).
         </p><pre class="codeinput">dir = [0 0 -1];    <span class="comment">% plane wave direction</span>

[center, normal] = centnorm(mesh);
[psi, qsi] = incident(<span class="string">'plane'</span>, dir, center, normal, k);

points = field.Nodes(:,2:4);    <span class="comment">% extract field points (vertices)</span>
pfi = incident(<span class="string">'plane'</span>, dir, points, [], k);

figure;
plot_mesh(field, real(pfi)); shading <span class="string">interp</span>;
plot_mesh(mesh, real(psi));
c = colorbar; ylabel(c, <span class="string">'Real incident pressure'</span>);
view(3);
</pre><img vspace="5" hspace="5" src="sph_scat_neum_04.png" alt=""> <h2>BEM matrices and solution<a name="7"></a></h2>
         <p>The BEM system matrices are generated by the toolbox function <tt>bemHG</tt>. The system of equations
         </p>
         <p><img src="sph_scat_neum_eq97481.png" alt="$$ {\bf H} {\bf p}_{ss} = {\bf G} {\bf q}_{ss} $$"></p>
         <p>is solved by matrix inversion. As a rigid scatterer is considered, the scattered velocity field is computed from the incident
            velocity as
         </p>
         <p><img src="sph_scat_neum_eq69915.png" alt="$$q_{ss} = -q_{si} $$"></p><pre class="codeinput">[H, G] = bemHG(mesh, k, <span class="string">'const'</span>);   <span class="comment">% Generate BEM matrices</span>
qss = -qsi;                         <span class="comment">% Boundary cond. at a rigid boundary</span>
pss = H \ (G * qss);                <span class="comment">% solve the system</span>
</pre><h2>Field point pressure and total pressure field (post processing)<a name="8"></a></h2>
         <p>The scattered field point pressure <img src="sph_scat_neum_eq23573.png" alt="$p_{fs}$"> is computed from the scattered surface pressure <img src="sph_scat_neum_eq98987.png" alt="$p_{ss}$"> and velocity <img src="sph_scat_neum_eq32815.png" alt="$q_{ss}$"> as
         </p>
         <p><img src="sph_scat_neum_eq65989.png" alt="$${\bf p}_{fs} = \frac{1}{4\pi} ({\bf H} {\bf p}_{ss} - {\bf G} {\bf q}_{ss})$$"></p>
         <p>where the system matrices are computed by the toolbox function <tt>bemHG</tt>.
         </p><pre class="codeinput">[H, G] = bemHG(mesh, k, <span class="string">'const'</span>, points);
pfs = (H * pss - G * qss) / (4*pi);
</pre><p>The total pressure field in the field points and on the surface is computed as</p>
         <p><img src="sph_scat_neum_eq33402.png" alt="$$ p_t = p_i + p_s $$"></p><pre class="codeinput">pst = psi + pss;
pft = pfi + pfs;

figure;
plot_mesh(field, 20*log10(abs(pft))); shading <span class="string">interp</span>;
plot_mesh(mesh, 20*log10(abs(pst)));
c = colorbar; ylabel(c, <span class="string">'Pressure magnitude [dB]'</span>);
view(3);
</pre><img vspace="5" hspace="5" src="sph_scat_neum_05.png" alt=""> <p class="footer"><br>
            Published with MATLAB&reg; 7.8<br></p>
      </div>
      <!--
##### SOURCE BEGIN #####
%% Neumann exterior scattering problem
% This tutorial introduces how to use the toolbox |NIHU| to solve a simple
% exterior acoustic scattering problem.
%
% The problem is scattering of an incident plane wave from a rigid sphere.

%% Surface and field point mesh
% Generate a sphere surface with given radius and division parameter. The
% division parameter is the number of elements along the radius of the
% sphere.
R = 1;      % radius
nR = 10;    % division parameter
mesh = create_sphere_boundary(R, nR);

%%
% Check that the mesh is directed outward by plotting the normals with the
% toolbox function |plot_elem_normals|
figure;
plot_mesh(mesh);
plot_elem_normals(mesh);
view(3);

%%
% The maximal applicable frequency is determined by the rule of thumb
% 
% $$L_e \le \lambda/7$$
% 
% The maximal applicable wave number at each element of the mesh is
% computed by the toolbox function |bemkmax|.
ratio = 7;                          % elements per wavelength
kmax_elem = bemkmax(mesh, ratio);   % max. wave number per element

figure;
plot_mesh(mesh, kmax_elem);
c = colorbar; ylabel(c, 'k_{max} [1/m]');
view(3);

%%
% The minimum of these wavenumber values
% is the overall frequency limit of computations with this mesh.
% In the present example, the wave number is set slightly lower than the
% maximum.
kmax = min(kmax_elem);
k = .9*kmax;

%%
% The field point mesh is an annular ring generated by revolving a line.
field = create_line([0 0 1.2*R; 0 0 3*R], 2*nR);
field = revolve_mesh(field, [0 0 0], [0 -1 0], pi/4/nR, 4*nR);

figure;
plot_mesh(mesh);
plot_mesh(field); view(3);

%% Incident wave field
% The incident wave field is a plane wave travelling in a given direction.
% The incident pressure field $p_{si}$ and pressure derivative field
% $q_{si}$ is computed in all surface DOF. In the present example,
% constant boundary elements are used, and the DOF locations are the
% element centers. The
% element centers and normals are obtained from the toolbox function
% |centnorm|, and the toolbox function |incident| computes the incident
% surface pressure and velocity field. For visualization purposes, the
% incident pressure field is computed in the field points (vertices of the
% field point mesh).
dir = [0 0 -1];    % plane wave direction

[center, normal] = centnorm(mesh);
[psi, qsi] = incident('plane', dir, center, normal, k);

points = field.Nodes(:,2:4);    % extract field points (vertices)
pfi = incident('plane', dir, points, [], k);

figure;
plot_mesh(field, real(pfi)); shading interp;
plot_mesh(mesh, real(psi));
c = colorbar; ylabel(c, 'Real incident pressure');
view(3);

%% BEM matrices and solution
% The BEM system matrices are generated by the toolbox function |bemHG|.
% The system of equations
%
% $$ {\bf H} {\bf p}_{ss} = {\bf G} {\bf q}_{ss} $$
%
% is solved by matrix inversion. As a rigid scatterer is considered, the
% scattered velocity field is computed from the incident velocity as
%
% $$q_{ss} = -q_{si} $$
%
[H, G] = bemHG(mesh, k, 'const');   % Generate BEM matrices
qss = -qsi;                         % Boundary cond. at a rigid boundary
pss = H \ (G * qss);                % solve the system

%% Field point pressure and total pressure field (post processing)
% The scattered field point pressure $p_{fs}$ is computed from the
% scattered surface pressure $p_{ss}$ and velocity $q_{ss}$ as
% 
% $${\bf p}_{fs} = \frac{1}{4\pi} ({\bf H} {\bf p}_{ss} - {\bf G} {\bf q}_{ss})$$
% 
% where the system matrices are computed by the toolbox function |bemHG|.
[H, G] = bemHG(mesh, k, 'const', points);
pfs = (H * pss - G * qss) / (4*pi);

%%
% The total pressure field in the field points and on the surface is
% computed as
%
% $$ p_t = p_i + p_s $$
%
pst = psi + pss;
pft = pfi + pfs;

figure;
plot_mesh(field, 20*log10(abs(pft))); shading interp;
plot_mesh(mesh, 20*log10(abs(pst)));
c = colorbar; ylabel(c, 'Pressure magnitude [dB]');
view(3);
##### SOURCE END #####
-->
   </body>
</html>