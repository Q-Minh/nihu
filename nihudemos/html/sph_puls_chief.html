
<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
      <!--
This HTML is auto-generated from an M-file.
To make changes, update the M-file and republish this document.
      -->
      <title>Fictitious eigenfrequencies and the CHIEF method</title>
      <meta name="generator" content="MATLAB 7.8">
      <meta name="date" content="2009-12-02">
      <meta name="m-file" content="sph_puls_chief"><style type="text/css">

body {
  background-color: white;
  margin:10px;
}

h1 {
  color: #990000; 
  font-size: x-large;
}

h2 {
  color: #990000;
  font-size: medium;
}

/* Make the text shrink to fit narrow windows, but not stretch too far in 
wide windows. */ 
p,h1,h2,div.content div {
  max-width: 600px;
  /* Hack for IE6 */
  width: auto !important; width: 600px;
}

pre.codeinput {
  background: #EEEEEE;
  padding: 10px;
}
@media print {
  pre.codeinput {word-wrap:break-word; width:100%;}
} 

span.keyword {color: #0000FF}
span.comment {color: #228B22}
span.string {color: #A020F0}
span.untermstring {color: #B20000}
span.syscmd {color: #B28C00}

pre.codeoutput {
  color: #666666;
  padding: 10px;
}

pre.error {
  color: red;
}

p.footer {
  text-align: right;
  font-size: xx-small;
  font-weight: lighter;
  font-style: italic;
  color: gray;
}

  </style></head>
   <body>
      <div class="content">
         <h1>Fictitious eigenfrequencies and the CHIEF method</h1>
         <!--introduction-->
         <p>This tutorial introduces how to use the toolbox <tt>NIHU</tt> to solve a simple exterior acoustic radiation problem with mitigating the problem of fictitious eigenfrequencies.
         </p>
         <p>The problem is radiation by a pulsating sphere to the infinite exterior domain. The boundary conditions are defined as prescribed
            pressure derivative (normal velocity) on the sphere surface. The computed surface pressures are compared with analytical solutions.
            It is shown that at the resonance frequencies of the internal domain, the deviation between analytical and numerical solutions
            becomes high. The Combined Helmholtz Integral Equation Formalism (CHIEF) is applied to mitigate this fictitious eigenfrequency
            problem.
         </p>
         <!--/introduction-->
         <h2>Contents</h2>
         <div>
            <ul>
               <li><a href="#1">Surface mesh generation</a></li>
               <li><a href="#3">Boundary conditions</a></li>
               <li><a href="#4">CHIEF points</a></li>
               <li><a href="#5">Generate BEM matrices and solve system</a></li>
               <li><a href="#6">Plot results</a></li>
            </ul>
         </div>
         <h2>Surface mesh generation<a name="1"></a></h2>
         <p>Generate a sphere geometry with given radius <img src="sph_puls_chief_eq85930.png" alt="$R$"> and division parameter <img src="sph_puls_chief_eq04645.png" alt="$n_R$">.
         </p><pre class="codeinput">R = 1;      <span class="comment">% radius</span>
nR = 8;     <span class="comment">% division parameter</span>
mesh = create_sphere_boundary(R, nR);
</pre><p>The frequency range is defined between <img src="sph_puls_chief_eq73068.png" alt="$k = 0$"> and <img src="sph_puls_chief_eq46735.png" alt="$k = k_{\mathrm{max}}$">, where the maximal applicable frequency is determined by the rule of thumb <img src="sph_puls_chief_eq60405.png" alt="$L_e \le \lambda / 8$">, and is computed by the toolbox function <a href="matlab:doc('bemkmax')">bemkmax</a>. The frequency range is selected as non uniform, so that a large number of frequency values is located around some preselected
            frequencies.
         </p><pre class="codeinput">kmax = min(bemkmax(mesh, 8));   <span class="comment">% maximal wave number</span>
mk = [pi 2*pi];                 <span class="comment">% preselected frequencies</span>
sk = [.01 .01];                 <span class="comment">% standard deviation at selected freq.</span>
kvec = linspace(0, kmax, 1000); <span class="comment">% wave number vector to define PDF</span>
fk = ones(size(kvec))/kmax;     <span class="comment">% uniform PDF</span>
<span class="keyword">for</span> iP = 1 : length(mk)         <span class="comment">% generate Gaussian peaks in frequency PDF</span>
    fk = fk + exp(-.5*((kvec-mk(iP))/sk(iP)).^2)/sqrt(2*pi*sk(iP));
<span class="keyword">end</span>
Fk = cumsum(fk) / sum(fk);      <span class="comment">% frequency CDF</span>
nK = 30;                        <span class="comment">% number of frequencies</span>
kvec = interp1(Fk, kvec, (1:nK)/nK);   <span class="comment">% trans. with inverse CDF</span>
</pre><h2>Boundary conditions<a name="3"></a></h2>
         <p>The boundary conditions are defied on the sphere element corners (nodes) as a uniform normal derivative <img src="sph_puls_chief_eq76633.png" alt="$q_s = 1$">.
         </p><pre class="codeinput">nNodes = size(mesh.Nodes,1);
qs = ones(nNodes,1);
</pre><h2>CHIEF points<a name="4"></a></h2>
         <p>A number of randomly distributed internal points are selected with the function <a href="matlab:doc('chiefgen')">chiefgen</a>. These points are used as overdetermination points in the system of equations.
         </p><pre class="codeinput">nChief = 50;
xChief = chiefgen(mesh, nChief);
</pre><h2>Generate BEM matrices and solve system<a name="5"></a></h2>
         <p>The original system of equations reads as</p>
         <p><img src="sph_puls_chief_eq94266.png" alt="$${\bf H}_s {\bf p}_s = {\bf G}_S {\bf q}_s$$"></p>
         <p>An additional system of equations is generated by writing the Helmholtz equation</p>
         <p><img src="sph_puls_chief_eq84061.png" alt="$$ {\bf H}_f {\bf p}_s - {\bf G}_f {\bf q}_s = {\bf 0}$$"></p>
         <p>with the CHIEF field points inside the domain. The combined system of equations is solved in a least squares sense.</p><pre class="codeinput">ps0 = -1 ./ (1+1i*kvec*R);  <span class="comment">% analytical pressure solution</span>
ps = zeros(nNodes, nK);     <span class="comment">% surface press. without mitigation</span>
psc = zeros(nNodes, nK);    <span class="comment">% surface press. with the CHIEF method</span>
e = zeros(1, nK);           <span class="comment">% relative error without mitigation</span>
ec = zeros(1, nK);          <span class="comment">% relative error with mitigation</span>
<span class="keyword">for</span> iK = 1 : nK     <span class="comment">% for each frequency value</span>
    k = kvec(iK);
    [H, G] = bemHG(mesh, k, <span class="string">'lin'</span>);             <span class="comment">% BEM matrices</span>
    [Hc, Gc] = bemHG(mesh, k, <span class="string">'lin'</span>, xChief);   <span class="comment">% CHIEF matrices</span>
    ps(:,iK) = H \ (G * qs);                <span class="comment">% solve the system</span>
    psc(:,iK) = [H; Hc] \ ([G; Gc] * qs);   <span class="comment">% solve overdetermined sys.</span>
    e(iK) = norm(ps(:,iK)-ps0(iK))/norm(repmat(ps0(iK),nNodes,1));
    ec(iK) = norm(psc(:,iK)-ps0(iK))/norm(repmat(ps0(iK),nNodes,1));
<span class="keyword">end</span>
</pre><h2>Plot results<a name="6"></a></h2>
         <p>The analytical solution with and without mitigation is plotted, as well as the relative error in both cases.</p><pre class="codeinput">figure;
subplot(2,1,1);
semilogy(kvec, abs(mean(ps)), kvec, abs(mean(psc)));
xlabel(<span class="string">'kR [-]'</span>);
ylabel(<span class="string">'Pressure magnitude'</span>);
legend(<span class="string">'no mitigation'</span>, <span class="string">'CHIEF'</span>);
subplot(2,1,2);
semilogy(kvec, e, kvec, ec);
xlabel(<span class="string">'kR [-]'</span>);
ylabel(<span class="string">'Relative error'</span>);
legend(<span class="string">'no mitigation'</span>, <span class="string">'CHIEF'</span>);
</pre><img vspace="5" hspace="5" src="sph_puls_chief_01.png" alt=""> <p class="footer"><br>
            Published with MATLAB&reg; 7.8<br></p>
      </div>
      <!--
##### SOURCE BEGIN #####
%% Fictitious eigenfrequencies and the CHIEF method
% This tutorial introduces how to use the toolbox |NIHU| to solve a simple
% exterior acoustic radiation problem with mitigating the problem of
% fictitious eigenfrequencies.
%
% The problem is radiation by a pulsating sphere to the infinite exterior
% domain. The boundary conditions are defined as prescribed pressure
% derivative (normal velocity) on the sphere surface.
% The computed surface pressures are compared with analytical solutions.
% It is shown that at the resonance frequencies of the internal domain, the
% deviation between analytical and numerical solutions becomes high. The
% Combined Helmholtz Integral Equation Formalism (CHIEF) is applied to
% mitigate this fictitious eigenfrequency problem.

%% Surface mesh generation
% Generate a sphere geometry with given radius $R$ and division parameter
% $n_R$.
R = 1;      % radius
nR = 8;     % division parameter
mesh = create_sphere_boundary(R, nR);

%%
% The frequency range is defined between $k = 0$ and
% $k = k_{\mathrm{max}}$, where the maximal applicable frequency is
% determined by the rule of thumb $L_e \le \lambda / 8$, and is
% computed by the toolbox function <matlab:doc('bemkmax') bemkmax>. 
% The frequency range is selected as non uniform, so that a large number
% of frequency values is located around some preselected frequencies.
kmax = min(bemkmax(mesh, 8));   % maximal wave number
mk = [pi 2*pi];                 % preselected frequencies
sk = [.01 .01];                 % standard deviation at selected freq.
kvec = linspace(0, kmax, 1000); % wave number vector to define PDF
fk = ones(size(kvec))/kmax;     % uniform PDF
for iP = 1 : length(mk)         % generate Gaussian peaks in frequency PDF
    fk = fk + exp(-.5*((kvec-mk(iP))/sk(iP)).^2)/sqrt(2*pi*sk(iP));
end
Fk = cumsum(fk) / sum(fk);      % frequency CDF
nK = 30;                        % number of frequencies
kvec = interp1(Fk, kvec, (1:nK)/nK);   % trans. with inverse CDF

%% Boundary conditions
% The boundary conditions are defied on the sphere element corners (nodes)
% as a uniform normal derivative $q_s = 1$.
nNodes = size(mesh.Nodes,1);
qs = ones(nNodes,1);

%% CHIEF points
% A number of randomly distributed internal points are selected with the
% function <matlab:doc('chiefgen') chiefgen>. These points are used as
% overdetermination points in the system of equations.
nChief = 50;
xChief = chiefgen(mesh, nChief);

%% Generate BEM matrices and solve system
% The original system of equations reads as
%
% $${\bf H}_s {\bf p}_s = {\bf G}_S {\bf q}_s$$
%
% An additional system of equations is generated by writing the Helmholtz
% equation
%
% $$ {\bf H}_f {\bf p}_s - {\bf G}_f {\bf q}_s = {\bf 0}$$
%
% with the CHIEF field points inside the domain. The combined system of
% equations is solved in a least squares sense.
ps0 = -1 ./ (1+1i*kvec*R);  % analytical pressure solution
ps = zeros(nNodes, nK);     % surface press. without mitigation
psc = zeros(nNodes, nK);    % surface press. with the CHIEF method
e = zeros(1, nK);           % relative error without mitigation
ec = zeros(1, nK);          % relative error with mitigation
for iK = 1 : nK     % for each frequency value
    k = kvec(iK);
    [H, G] = bemHG(mesh, k, 'lin');             % BEM matrices
    [Hc, Gc] = bemHG(mesh, k, 'lin', xChief);   % CHIEF matrices
    ps(:,iK) = H \ (G * qs);                % solve the system
    psc(:,iK) = [H; Hc] \ ([G; Gc] * qs);   % solve overdetermined sys.
    e(iK) = norm(ps(:,iK)-ps0(iK))/norm(repmat(ps0(iK),nNodes,1));
    ec(iK) = norm(psc(:,iK)-ps0(iK))/norm(repmat(ps0(iK),nNodes,1));
end

%% Plot results
% The analytical solution with and without mitigation is plotted, as well
% as the relative error in both cases.
figure;
subplot(2,1,1);
semilogy(kvec, abs(mean(ps)), kvec, abs(mean(psc)));
xlabel('kR [-]');
ylabel('Pressure magnitude');
legend('no mitigation', 'CHIEF');
subplot(2,1,2);
semilogy(kvec, e, kvec, ec);
xlabel('kR [-]');
ylabel('Relative error');
legend('no mitigation', 'CHIEF');
##### SOURCE END #####
-->
   </body>
</html>