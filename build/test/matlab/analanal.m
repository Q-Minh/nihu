rvec = [1 1 1]';
n = [1 0 0]';
nu = .3;
mu = 1e8;
rho = 100;

r = norm(rvec);
gradr = rvec / r;
rdn = dot(gradr, n, 1);

a = sqrt((1-2*nu)/2/(1-nu));
a2 = a*a;
lambdapermu = (1/a2 - 2);
cS = sqrt(mu/rho);

om = sym('om', 'positive');
kSr = om / cS * r;
kPr = a * kSr;

psi = exp(-1i*kPr) * a2 * (     1i/kPr + 1./(kPr*kPr))...
    + exp(-1i*kSr) *      (1. - 1i/kSr - 1./(kSr*kSr));

chi = exp(-1i*kPr) * a2 * (1. - 3.*1i/kPr - 3./(kPr*kPr))...
    - exp(-1i*kSr) *      (1. - 3.*1i/kSr - 3./(kSr*kSr));

dpsi = (...
    exp(-1i*kPr) * a2 * (1.         - 2.*1i/kPr - 2./(kPr*kPr)) -...
    exp(-1i*kSr) *      (1. + 1i*kSr - 2.*1i/kSr - 2./(kSr*kSr))...
    ) / r;

dchi = (...
    exp(-1i*kSr) *      (3. + 1i*kSr - 6.*1i/kSr - 6./(kSr*kSr)) -...
    exp(-1i*kPr) * a2 * (3. + 1i*kPr - 6.*1i/kPr - 6./(kPr*kPr))...
    ) / r;

A = dpsi - psi/r;
B = dchi - 3.*chi/r;
C = chi/r;

T = (...
    eye(3) * rdn * (A+C)...
    +...
    rdn * 2. * B * (gradr * gradr.')...
    +...
    (2.*C + lambdapermu*(A+B+4.*C)) * (n * gradr.')...
    +...
    (A+C) * (gradr * n.')...
    ) / (4.*pi*r);

T0_dyn = double(limit(T, om, 0));

T0 = (-rdn * ((1-2*nu)*eye(3) + 3*(gradr*gradr.')) + (1-2*nu)*(gradr*n.'-n*gradr.')) / (8*pi*(1-nu)*r^2);